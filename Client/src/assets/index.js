import TailDown from "./taildown";

function index() {
  const routes = {
    "/": {
      component: "WelcomeComponent",
    },
    "/dashboard": {
      component: "HomeComponent",
    },
    "/auth": {
      component: "AuthComponent",
    },
    "/apis": {
      component: "APIsComponent",
    },
    "/scripts": {
      component: "ScriptsComponent",
    },
    "/docs": {
      component: "DocsComponent",
    },
    "/tools": {
      component: "ToolsComponent",
    },
    "/scripts/new": {
      component: "NewScriptComponent",
    },
    "/manage-script": {
      component: "ManageComponent",
    },
    "/tools/hub": {
      component: "ScriptHubComponent",
    },
    "/tools/obfuscator": {
      component: "ObfuscatorComponent",
    },
  };
  if (localStorage.token) {
    const path = window.location.pathname ? window.location.pathname : "/";
    routes[path]
      ? (document.getElementById(routes[path].component).style.display = "")
      : document.getElementById("ErrorComponent404")
      ? (document.getElementById("ErrorComponent404").style.display = "")
      : "";

    const Markdown = new TailDown({
      a: {
        customClass: `text-${localStorage.color}`,
      },
      p: {
        customClass: "text-gray-300",
      },
      h1: {
        customClass: "text-gray-300",
      },
    });
    document.getElementById("docs").innerHTML = Markdown.parse(`
## **BloxSafe**
Welcome to the [documentation](/docs), here you will learn to use the panel.



### **Dashboard**
<small>On the dashboard page you can view your stats and scripts. To edit a script click on the "manage" button, this will
take you to the script edit page, from their you can change the code, change name, get link and configure script
settings.</small>



### **APIs**
<small>You can use the APIs to manage your data programatically. You can generate API keys from the APIs page.</small>



### **Tools**
<small>BloxSafe offers tools like [Obfuscator](/tools/obfuscator), [Script Hub](/tools/hub), [Discord Webhook](/tools/webhook) and more. The obfuscation tool is to make your code unreadable to prevent stealing. The script hub tool creates a roblox script hub with your scripts, the script hub code is auto generated by BloxSafe. You can also connect your discord wehbook to receive important information.</small>
`);
    fetch(`${window.$BackendURL}/api/v1/me`, {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
      },
      body: JSON.stringify({ token: localStorage.token }),
    })
      .then((response) => response.json())
      .then((data) => {
        if (data.Data.token) {
          localStorage.token = data.Data.token;
        } else {
          localStorage.removeItem("token");
        }
      });
  } else {
    // not logged in
    if (!window.location.pathname == "/auth") {
      window.location.href = "/auth";
    }
    document.getElementById("AuthComponent").style.display = "";
  }

}

export default index;
